<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:applications="clr-namespace:Calculator.ViewModel.ViewModels.Applications;assembly=Calculator.ViewModel"
    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:behaviors="clr-namespace:Calculator.Controls.Behaviors;assembly=Calculator.Controls"
    xmlns:converter="clr-namespace:Jg.wpf.controls.Converter;assembly=Jg.wpf.controls"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:patients="clr-namespace:Calculator.ViewModel.ViewModels.Patients;assembly=Calculator.ViewModel"
    xmlns:selectors="clr-namespace:Calculator.Selectors"
    xmlns:utilities="clr-namespace:Calculator.Controls.Utilities;assembly=Calculator.Controls">

    <converter:MathConverter x:Key="MathConverter" />

    <Style
        x:Key="test"
        BasedOn="{StaticResource MaterialDesignListBoxItem}"
        TargetType="{x:Type ListBoxItem}">
        <Setter Property="Padding" Value="0" />
    </Style>

    <DataTemplate x:Key="AddPatientDataTemplate" DataType="{x:Type patients:AddPatientViewModel}">
        <StackPanel Margin="4">
            <StackPanel Orientation="Horizontal">
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <TextBox
                        Margin="4"
                        materialDesign:HintAssist.Hint="姓名"
                        Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                        Text="{Binding NewPatient.Name}" />
                </Border>
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <DatePicker
                        Margin="4"
                        VerticalAlignment="Center"
                        VerticalContentAlignment="Bottom"
                        materialDesign:HintAssist.Hint="出生日期"
                        materialDesign:TextFieldAssist.HasClearButton="True"
                        DisplayDate="{Binding NewPatient.Birthday}"
                        SelectedDate="{Binding NewPatient.Birthday}"
                        Style="{StaticResource MaterialDesignFloatingHintDatePicker}" />
                </Border>
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <TextBox
                        Margin="4"
                        materialDesign:HintAssist.Hint="体重"
                        Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                        Text="{Binding NewPatient.Weight}" />
                </Border>
            </StackPanel>
            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                <Button
                    Margin="0,8,8,0"
                    Command="{Binding SavePatientCommand}"
                    Content="OK"
                    IsDefault="True"
                    Style="{StaticResource MaterialDesignFlatButton}" />
                <Button
                    Margin="0,8,8,0"
                    Command="{Binding CancelCommand}"
                    Content="Cancel"
                    IsCancel="True"
                    Style="{StaticResource MaterialDesignFlatButton}" />
            </StackPanel>
        </StackPanel>
    </DataTemplate>
    <DataTemplate x:Key="EditPatientDataTemplate" DataType="{x:Type patients:EditPatientViewModel}">
        <StackPanel Margin="4">
            <StackPanel Orientation="Horizontal">
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <TextBox
                        Margin="4"
                        materialDesign:HintAssist.Hint="姓名"
                        Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                        Text="{Binding EditPatient.Name}" />
                </Border>
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <DatePicker
                        Margin="4"
                        VerticalAlignment="Center"
                        VerticalContentAlignment="Bottom"
                        materialDesign:HintAssist.Hint="出生日期"
                        materialDesign:TextFieldAssist.HasClearButton="True"
                        DisplayDate="{Binding EditPatient.Birthday}"
                        SelectedDate="{Binding EditPatient.Birthday}"
                        Style="{StaticResource MaterialDesignFloatingHintDatePicker}" />
                </Border>
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <TextBox
                        Margin="4"
                        materialDesign:HintAssist.Hint="体重"
                        Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                        Text="{Binding EditPatient.Weight}" />
                </Border>
            </StackPanel>
            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                <Button
                    Margin="0,8,8,0"
                    Command="{Binding SavePatientCommand}"
                    Content="OK"
                    IsDefault="True"
                    Style="{StaticResource MaterialDesignFlatButton}" />
                <Button
                    Margin="0,8,8,0"
                    Command="{Binding CancelCommand}"
                    Content="Cancel"
                    IsCancel="True"
                    Style="{StaticResource MaterialDesignFlatButton}" />
            </StackPanel>
        </StackPanel>
    </DataTemplate>
    <DataTemplate x:Key="CalculateDataTemplate" DataType="{x:Type patients:CalculateViewModel}">
        <StackPanel
            x:Name="Panel"
            Width="520"
            Margin="4">
            <!--常规信息-->
            <StackPanel Orientation="Horizontal">
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <TextBox
                        Margin="4"
                        materialDesign:HintAssist.Hint="姓名"
                        Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                        Text="{Binding Patient.Name}" />
                </Border>
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <DatePicker
                        Margin="4"
                        VerticalAlignment="Center"
                        VerticalContentAlignment="Bottom"
                        materialDesign:HintAssist.Hint="出生日期"
                        materialDesign:TextFieldAssist.HasClearButton="True"
                        DisplayDate="{Binding Patient.Birthday}"
                        SelectedDate="{Binding Patient.Birthday}"
                        Style="{StaticResource MaterialDesignFloatingHintDatePicker}" />
                </Border>
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <TextBox
                        Margin="4"
                        materialDesign:HintAssist.Hint="体重"
                        Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                        Text="{Binding Patient.Weight}" />
                </Border>
            </StackPanel>
            <!--计算变量-->
            <StackPanel Orientation="Horizontal">
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <TextBox
                        Margin="4"
                        materialDesign:HintAssist.Hint="{Binding Property1.Name}"
                        Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                        Text="{Binding Property1.Value}" />
                </Border>
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <TextBox
                        Margin="4"
                        materialDesign:HintAssist.Hint="{Binding Property2.Name}"
                        Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                        Text="{Binding Property2.Value}" />
                </Border>
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <TextBox
                        Margin="4"
                        materialDesign:HintAssist.Hint="{Binding Property3.Name}"
                        Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                        Text="{Binding Property3.Value}" />
                </Border>
                <Border
                    Width="120"
                    Margin="4"
                    BorderBrush="LightGray">
                    <TextBox
                        Margin="4"
                        materialDesign:HintAssist.Hint="{Binding Property4.Name}"
                        Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                        Text="{Binding Property4.Value}" />
                </Border>
            </StackPanel>
            <!--计算变量-->
            <StackPanel Orientation="Vertical">
                <Border Margin="4" BorderBrush="LightGray">
                    <ListBox ItemContainerStyle="{StaticResource test}" ItemsSource="{Binding VariableCommands}">
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel IsItemsHost="True" Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Button
                                    Width="36"
                                    Height="36"
                                    Margin="2"
                                    Padding="0"
                                    Command="{Binding .}"
                                    CommandParameter="{Binding Id}"
                                    Content="{Binding Description}" />
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Border>
                <Border Margin="4" BorderBrush="LightGray">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Width="40"
                            Margin="4"
                            Text="公式：" />
                        <RichTextBox Name="rich1" Grid.Column="1" Width="{Binding ActualWidth, ElementName=Panel, Converter={StaticResource MathConverter}, ConverterParameter=x-60}">
                            <FlowDocument>
                                <Paragraph>
                                    <Paragraph.Inlines />
                                </Paragraph>
                            </FlowDocument>
                            <b:Interaction.Behaviors>
                                <behaviors:CustomRichTextBoxBehavior SyncCaret ="True"  ShowName="True" Variables="{Binding SettingVariables}" />
                            </b:Interaction.Behaviors>
                        </RichTextBox>
                    </Grid>
                </Border>
                <Border Margin="4" BorderBrush="LightGray">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Width="40"
                            Margin="4"
                            Text="数值：" />
                        <RichTextBox Name="rich2" Grid.Column="1" Width="{Binding ActualWidth, ElementName=Panel, Converter={StaticResource MathConverter}, ConverterParameter=x-60}">
                            <FlowDocument>
                                <Paragraph>
                                    <Paragraph.Inlines />
                                </Paragraph>
                            </FlowDocument>
                            <b:Interaction.Behaviors>
                                <behaviors:CustomRichTextBoxBehavior SyncCaret ="True"  ShowName="False" Variables="{Binding SettingVariables}" />
                            </b:Interaction.Behaviors>
                        </RichTextBox>
                    </Grid>
                </Border>
            </StackPanel>

            <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                <Button
                    Margin="0,8,8,0"
                    Command="{Binding CalculateCommand}"
                    Content="Calc"
                    IsDefault="True"
                    Style="{StaticResource MaterialDesignFlatButton}" />
                <Button
                    Margin="0,8,8,0"
                    Command="{Binding SaveCommand}"
                    Content="Save"
                    IsDefault="True"
                    Style="{StaticResource MaterialDesignFlatButton}" />
                <Button
                    Margin="0,8,8,0"
                    Command="{Binding CancelCommand}"
                    Content="Cancel"
                    IsCancel="True"
                    Style="{StaticResource MaterialDesignFlatButton}" />
            </StackPanel>
        </StackPanel>
    </DataTemplate>

    <DataTemplate x:Key="MessageDataTemplate" DataType="{x:Type applications:MessageViewModel}">
        <Grid Width="300" Height="100">
            <StackPanel Margin="4" VerticalAlignment="Center">
                <TextBlock
                    Margin="4"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontSize="16"
                    Text="{Binding Message}" />
                <StackPanel HorizontalAlignment="Right" Orientation="Horizontal">
                    <Button
                        Margin="0,8,8,0"
                        Command="{Binding CloseMessageCommand}"
                        Content="OK"
                        IsDefault="True"
                        Style="{StaticResource MaterialDesignFlatButton}" />
                </StackPanel>
            </StackPanel>

        </Grid>
    </DataTemplate>

    <selectors:PatientDialogContentSelector
        x:Key="PatientDialogContentSelector"
        AddPatientDataTemplate="{StaticResource AddPatientDataTemplate}"
        CalculateDataTemplate="{StaticResource CalculateDataTemplate}"
        EditPatientDataTemplate="{StaticResource EditPatientDataTemplate}"
        MessageDataTemplate="{StaticResource MessageDataTemplate}" />

</ResourceDictionary>